<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <title>JSDoc: Source: sw-utils.js</title>

    <script src="scripts/prettify/prettify.js"> </script>
    <script src="scripts/prettify/lang-css.js"> </script>
    <!--[if lt IE 9]>
      <script src="//html5shiv.googlecode.com/svn/trunk/html5.js"></script>
    <![endif]-->
    <link type="text/css" rel="stylesheet" href="styles/prettify-tomorrow.css">
    <link type="text/css" rel="stylesheet" href="styles/jsdoc-default.css">
</head>

<body>

<div id="main">

    <h1 class="page-title">Source: sw-utils.js</h1>

    



    
    <section>
        <article>
            <pre class="prettyprint source linenums"><code>/**
 * Utility functions for Service Worker library.
 * @module SW_Utils
 * @exports injectServiceWorker
 * @exports updateServiceWorker
 * @exports unregisterServiceWorker
 * @exports clearData
 */


/**
 * Handles service worker installation.
 * @function injectServiceWorker
 * @param {funtion} updateCallback - Callback to be triggered when service worker update is found.
 */
function injectServiceWorker(updateCallback) {
    if ('serviceWorker' in navigator) {
        navigator.serviceWorker.register('/service-worker.js')
            .then((reg) => {
                reg.addEventListener('updatefound', () => {
                    const newWorker = reg.installing;
                    newWorker.addEventListener('statechange', () => {
                        if (navigator.serviceWorker.controller &amp;&amp; reg.waiting &amp;&amp; newWorker.state === 'installed') {
                            const awaitingSW = reg.waiting;
                            if (updateCallback &amp;&amp; typeof updateCallback === 'function') {
                                updateCallback(awaitingSW);
                            }
                        }
                    });
                });
            }, (err) => {
                throw new Error('Service worker registration failed: ', err);
            });
        navigator.serviceWorker.addEventListener('message', (event) => {
            if (event.data === 'RELOAD') {
                window.location.reload();
            }
        });
    }
}

/**
 * Handles service worker update.
 * @function updateServiceWorker
 */
function updateServiceWorker() {
    if ('serviceWorker' in navigator) {
        navigator.serviceWorker.ready.then((registration) => {
            registration.update();
        });
    }
}

/**
 * Removes all existing service worker registration.
 * @function unregisterServiceWorker
 */
function unregisterServiceWorker() {
    if ('serviceWorker' in navigator) {
        navigator.serviceWorker.getRegistrations().then((registrations) => {
            registrations.forEach((registration) => {
                registration.unregister();
            });
        });
    }
}

/**
 * Triggers CLEAR-DATA message for service worker.
 * @function clearData
 */
function clearData() {
    if ('serviceWorker' in navigator) {
        navigator.serviceWorker.controller.postMessage({
            type: 'CLEAR-DATA',
        });
    }
}

module.exports = {
    injectServiceWorker,
    updateServiceWorker,
    unregisterServiceWorker,
    clearData,
};
</code></pre>
        </article>
    </section>




</div>

<nav>
    <h2><a href="index.html">Home</a></h2><h3>Modules</h3><ul><li><a href="module-Helper.html">Helper</a></li><li><a href="module-SW_Generator.html">SW_Generator</a></li><li><a href="module-SW_Utils.html">SW_Utils</a></li></ul><h3>Classes</h3><ul><li><a href="module-SW_Generator-ServiceWorkerGenerator.html">ServiceWorkerGenerator</a></li></ul>
</nav>

<br class="clear">

<footer>
    Documentation generated by <a href="https://github.com/jsdoc3/jsdoc">JSDoc 3.5.5</a> on Tue May 22 2018 18:34:52 GMT+0530 (IST)
</footer>

<script> prettyPrint(); </script>
<script src="scripts/linenumber.js"> </script>
</body>
</html>
